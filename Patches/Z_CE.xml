<?xml version="1.0" encoding="utf-8" ?>

<Patch>

	<!-- Wood Logs Stat Fixes -->
	<Operation Class="PatchOperationSequence">
		<success>Always</success>
		<operations>
			<li Class="ExpandedWoodworking.PatchOperationModCompat">
				<modName>Combat Extended</modName>
			</li>
			<li Class="PatchOperationReplace">
				<xpath>Defs/ThingDef[@Name="WoodLogBase"]/tools</xpath>
				<value>
					<tools>
						<li Class="CombatExtended.ToolCE">
							<capacities>
								<li>Blunt</li>
							</capacities>
							<power>10</power>
							<cooldownTime>1.85</cooldownTime>
							<armorPenetration>0.118</armorPenetration>
						</li>
					</tools>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[@Name="WoodLogBase"]</xpath>
				<value>
					<equippedStatOffsets>
						<MeleeCritChance>0.1</MeleeCritChance>
						<MeleeParryChance>0.175</MeleeParryChance>
					</equippedStatOffsets>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[@Name="WoodLogBase"]/statBases</xpath>
				<value>
					<Bulk>0.07</Bulk>
					<MeleeCounterParryBonus>1.25</MeleeCounterParryBonus>
				</value>
			</li>
			<li Class="PatchOperationReplace">
				<xpath>Defs/ThingDef[@Name="WoodLogBase"]/statBases/StuffPower_Armor_Sharp</xpath>
				<value>
					<StuffPower_Armor_Sharp>0.25</StuffPower_Armor_Sharp>
				</value>
			</li>
			<li Class="PatchOperationReplace">
				<xpath>Defs/ThingDef[@Name="WoodLogBase"]/statBases/StuffPower_Armor_Blunt</xpath>
				<value>
					<StuffPower_Armor_Blunt>0.5</StuffPower_Armor_Blunt>
				</value>
			</li>
			<li Class="PatchOperationReplace">
				<xpath>Defs/ThingDef[@Name="WoodLogBase"]/statBases/SharpDamageMultiplier</xpath>
				<value>
					<SharpDamageMultiplier>0.5</SharpDamageMultiplier>
				</value>
			</li>
			<li Class="PatchOperationReplace">
				<xpath>Defs/ThingDef[@Name="WoodLogBase"]/statBases/BluntDamageMultiplier</xpath>
				<value>
					<BluntDamageMultiplier>0.7</BluntDamageMultiplier>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[@Name="WoodLogBase"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.3</Mass>
					<MeleePenetrationFactor>0.3</MeleePenetrationFactor>
				</value>
			</li>
		</operations>
	</Operation>
	
	<!-- Log Wall Repeat Bomb Damage Definiton Fix -->
	<Operation Class="PatchOperationSequence">
		<success>Always</success>
		<operations>
			<li Class="ExpandedWoodworking.PatchOperationModCompat">
				<modName>Combat Extended</modName>
			</li>
			<li Class="PatchOperationAttributeSet">
				<xpath>Defs/ThingDef[defName = "EW_LogWall"]</xpath>
				<attribute>ParentName</attribute>
				<value>BuildingNaturalBase</value>
			</li>
			<li Class="PatchOperationRemove">
				<xpath>Defs/ThingDef[defName = "EW_LogWall"]/damageMultipliers</xpath>
			</li>
		</operations>
	</Operation>
	
	<!-- Tribal Warrior Weapon Money Fix (for being possibly too poor to have a weapon) -->
	<Operation Class="PatchOperationSequence">
		<success>Always</success>
		<operations>
			<li Class="ExpandedWoodworking.PatchOperationModCompat">
				<modName>Combat Extended</modName>
			</li>
			<li Class="PatchOperationReplace">
				<xpath>Defs/PawnKindDef[defName = "Tribal_Warrior"]/weaponMoney/min</xpath>
				<value>
					<min>120</min>
				</value>
			</li>
		</operations>
	</Operation>
	
	<!-- Weapon(Ranged Neolithic) Costs Fixes -->
	<Operation Class="PatchOperationSequence">
		<success>Always</success>
		<operations>
			<li Class="ExpandedWoodworking.PatchOperationModCompat">
				<modName>Combat Extended</modName>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "Pila"]</xpath>
				<value>
					<costList>
						<Steel>1</Steel>
					</costList>
				</value>
			</li>
			<li Class="PatchOperationReplace">
				<xpath>Defs/ThingDef[defName = "Pila"]/costStuffCount</xpath>
				<value>
					<costStuffCount>1</costStuffCount>
				</value>
			</li>
		</operations>
	</Operation>
	
	<Operation Class="PatchOperationSequence">
		<success>Always</success>
		<operations>
			<li Class="ExpandedWoodworking.PatchOperationModCompat">
				<modName>Combat Extended</modName>
			</li>
			<li Class="PatchOperationReplace">
				<xpath>Defs/ThingDef[defName = "Bow_Short"]/costStuffCount</xpath>
				<value>
					<costStuffCount>10</costStuffCount>
				</value>
			</li>
			<li Class="PatchOperationReplace">
				<xpath>Defs/ThingDef[defName = "Bow_Recurve"]/costStuffCount</xpath>
				<value>
					<costStuffCount>15</costStuffCount>
				</value>
			</li>
			<li Class="PatchOperationReplace">
				<xpath>Defs/ThingDef[defName = "Bow_Great"]/costStuffCount</xpath>
				<value>
					<costStuffCount>20</costStuffCount>
				</value>
			</li>
		</operations>
	</Operation>
	
	 <!-- Mass statFactor for all logs (MaxHitPoints / 0.4 * 0.3) -->
	<Operation Class="PatchOperationSequence">
		<success>Always</success>
		<operations>
			<li Class="ExpandedWoodworking.PatchOperationModCompat">
				<modName>Combat Extended</modName>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "WoodLog_Birch"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.3375</Mass>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "WoodLog_Palm"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.6</Mass>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "WoodLog_Cecropia"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.225</Mass>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "WoodLog_Cocoa"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.3375</Mass>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "WoodLog_Cypress"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.4875</Mass>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "WoodLog_Drago"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.3</Mass>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "WoodLog_Maple"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.4125</Mass>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "WoodLog_Oak"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.4875</Mass>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "WoodLog_Pine"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.375</Mass>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "WoodLog_Poplar"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.3</Mass>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "WoodLog_Saguaro"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.225</Mass>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "WoodLog_Teak"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.525</Mass>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "WoodLog_Willow"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.3</Mass>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "Bamboo"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.2625</Mass>
				</value>
			</li>
		</operations>
	</Operation>
	
	<!-- Mass statFactor for all lumber (MaxHitPoints / 0.4 * 0.3) -->
	<Operation Class="PatchOperationSequence">
		<success>Always</success>
		<operations>
			<li Class="ExpandedWoodworking.PatchOperationModCompat">
				<modName>Combat Extended</modName>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[@Name = "WoodLumberBase"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.3</Mass>
					<Bulk>0.03</Bulk>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "LumberBirch"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.3375</Mass>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "LumberPalm"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.6</Mass>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "LumberCecropia"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.225</Mass>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "LumberCocoa"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.3375</Mass>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "LumberCypress"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.4875</Mass>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "LumberDrago"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.3</Mass>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "LumberMaple"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.4125</Mass>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "LumberOak"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.4875</Mass>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "LumberPine"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.375</Mass>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "LumberPoplar"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.3</Mass>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "LumberTeak"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.525</Mass>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "LumberWillow"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.3</Mass>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "LumberBamboo"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.2625</Mass>
				</value>
			</li>
		</operations>
	</Operation>
	
	<!-- The Acacia Conundrum -->
	<Operation Class="PatchOperationFindMod">
		<mods>
			<li>Combat Extended</li>
		</mods>
		<match Class="PatchOperationFindMod">
			<mods>
				<li>VGP Xtra Trees and Flowers</li>
			</mods>
			<nomatch Class="PatchOperationFindMod">
				<mods>
					<li>[RF] Realistic Planets [1.0]</li>
					<li>Advanced Biomes</li>
					<li>Nature's Pretty Sweet</li>
				</mods>
				<match Class="PatchOperationAdd">
					<xpath>Defs/ThingDef[defName = "WoodLog_Acacia"]/stuffProps/statFactors</xpath>
					<value>
						<Mass>0.78375</Mass>
					</value>
				</match>
			</nomatch>
		</match>
	</Operation>

	<Operation Class="PatchOperationFindMod">
		<mods>
			<li>Combat Extended</li>
		</mods>
		<match Class="PatchOperationFindMod">
			<mods>
				<li>VGP Xtra Trees and Flowers</li>
			</mods>
			<nomatch Class="PatchOperationFindMod">
				<mods>
					<li>[RF] Realistic Planets [1.0]</li>
					<li>Advanced Biomes</li>
					<li>Nature's Pretty Sweet</li>
				</mods>
				<match Class="PatchOperationAdd">
					<xpath>Defs/ThingDef[defName = "LumberAcacia"]/stuffProps/statFactors</xpath>
					<value>
						<Mass>0.78375</Mass>
					</value>
				</match>
			</nomatch>
		</match>
	</Operation>
	
	<!-- <Operation Class="PatchOperationSequence">
		<success>Always</success>
		<operations>
			<li Class="ExpandedWoodworking.PatchOperationModCompat">
				<modList>
					<li>Combat Extended</li>
					<li>VGP Xtra Trees and Flowers</li>
					<li>Expanded Woodworking for Vegetable Garden Project</li>
				</modList>	
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "WoodLog_Acacia"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.78375</Mass>
				</value>
			</li>
		</operations>
	</Operation>
	
	<Operation Class="PatchOperationSequence">
		<success>Always</success>
		<operations>
			<li Class="ExpandedWoodworking.PatchOperationModCompat">
				<modList>
					<li>Combat Extended</li>
					<li>VGP Xtra Trees and Flowers</li>
					<li>Expanded Woodworking for Vegetable Garden Project</li>
				</modList>	
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "LumberAcacia"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.78375</Mass>
				</value>
			</li>
		</operations>
	</Operation>
	
	<Operation Class="PatchOperationSequence">
		<success>Always</success>
		<operations>
			<li Class="ExpandedWoodworking.PatchOperationModCompat">
				<modName>Combat Extended</modName>
			</li>
			<li Class="ExpandedWoodworking.PatchOperationModCompat">
				<modName>[RF] Realistic Planets [1.0]</modName>
			</li>
			<li Class="ExpandedWoodworking.PatchOperationModCompat">
				<modName>VGP Xtra Trees and Flowers</modName>
				<success>Invert</success>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "WoodLog_Acacia"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.78375</Mass>
				</value>
			</li>
		</operations>
	</Operation>
	
	<Operation Class="PatchOperationSequence">
		<success>Always</success>
		<operations>
			<li Class="ExpandedWoodworking.PatchOperationModCompat">
				<modName>Combat Extended</modName>
			</li>
			<li Class="ExpandedWoodworking.PatchOperationModCompat">
				<modName>[RF] Realistic Planets [1.0]</modName>
			</li>
			<li Class="ExpandedWoodworking.PatchOperationModCompat">
				<modName>VGP Xtra Trees and Flowers</modName>
				<success>Invert</success>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "LumberAcacia"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.78375</Mass>
				</value>
			</li>
		</operations>
	</Operation>
	
	<Operation Class="PatchOperationSequence">
		<success>Always</success>
		<operations>
			<li Class="ExpandedWoodworking.PatchOperationModCompat">
				<modName>Combat Extended</modName>
			</li>
			<li Class="ExpandedWoodworking.PatchOperationModCompat">
				<modName>Nature's Pretty Sweet</modName>
			</li>
			<li Class="ExpandedWoodworking.PatchOperationModCompat">
				<modName>[RF] Realistic Planets [1.0]</modName>
				<success>Invert</success>
			</li>
			<li Class="ExpandedWoodworking.PatchOperationModCompat">
				<modName>VGP Xtra Trees and Flowers</modName>
				<success>Invert</success>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "WoodLog_Acacia"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.78375</Mass>
				</value>
			</li>
		</operations>
	</Operation>
	
	<Operation Class="PatchOperationSequence">
		<success>Always</success>
		<operations>
			<li Class="ExpandedWoodworking.PatchOperationModCompat">
				<modName>Combat Extended</modName>
			</li>
			<li Class="ExpandedWoodworking.PatchOperationModCompat">
				<modName>Nature's Pretty Sweet</modName>
			</li>
			<li Class="ExpandedWoodworking.PatchOperationModCompat">
				<modName>[RF] Realistic Planets [1.0]</modName>
				<success>Invert</success>
			</li>
			<li Class="ExpandedWoodworking.PatchOperationModCompat">
				<modName>VGP Xtra Trees and Flowers</modName>
				<success>Invert</success>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>Defs/ThingDef[defName = "LumberAcacia"]/stuffProps/statFactors</xpath>
				<value>
					<Mass>0.78375</Mass>
				</value>
			</li>
		</operations>
	</Operation> -->
	
</Patch>